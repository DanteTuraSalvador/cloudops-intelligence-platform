# AWS Deployment Plan - CloudOps Intelligence Platform Demo

## üéØ Goal
Deploy a working demo on AWS that showcases:
- Live metrics collection from AWS CloudWatch
- Cost tracking from AWS Cost Explorer
- Interactive dashboard accessible via public URL
- Real-time data flowing through the system

---

## üìã Prerequisites Checklist

‚úÖ AWS Account (ap-southeast-2 region)
‚úÖ AWS CLI configured with credentials
‚úÖ DynamoDB tables created (cloudops-metrics, cloudops-costs)
‚úÖ Mock data inserted for demo
‚úÖ Code ready in GitHub

Still Needed:
- [ ] Verify AWS account limits (Lambda, API Gateway, CloudFront)
- [ ] Check billing alerts are configured
- [ ] Ensure IAM permissions for deployments

---

## üöÄ Deployment Strategy (Simplified for Demo)

We'll deploy in this order to minimize complexity and cost:

### Phase 1: Backend Services (2-3 hours)
Deploy the data collection and API services to AWS Lambda

### Phase 2: Frontend Hosting (1 hour)
Deploy the Next.js dashboard to S3 + CloudFront

### Phase 3: Automation (1 hour)
Set up EventBridge schedules for automatic data collection

### Phase 4: Testing & Demo Data (1 hour)
Verify everything works and populate with demo data

**Total Estimated Time: 5-6 hours**

---

## üì¶ Phase 1: Backend Services Deployment

### Step 1.1: Deploy API Gateway Service
**What:** REST API for frontend to fetch metrics and costs
**How:** Lambda Function + API Gateway HTTP API

```bash
# Build the service
cd services/api-gateway
pnpm install
pnpm build

# Package for Lambda
zip -r api-gateway.zip dist node_modules package.json

# Create Lambda function
aws lambda create-function \
  --function-name cloudops-api-gateway \
  --runtime nodejs22.x \
  --handler dist/server.handler \
  --zip-file fileb://api-gateway.zip \
  --role arn:aws:iam::YOUR_ACCOUNT_ID:role/cloudops-lambda-role \
  --timeout 30 \
  --memory-size 512 \
  --environment Variables="{
    AWS_REGION=ap-southeast-2,
    DYNAMODB_ENDPOINT=,
    METRICS_TABLE=cloudops-metrics,
    COSTS_TABLE=cloudops-costs
  }"

# Create API Gateway
aws apigatewayv2 create-api \
  --name cloudops-api \
  --protocol-type HTTP \
  --cors-configuration AllowOrigins='*',AllowMethods='GET,POST,OPTIONS'

# Create route and integration
# (detailed steps below)
```

**Expected Result:** API Gateway URL like `https://abc123.execute-api.ap-southeast-2.amazonaws.com`

### Step 1.2: Deploy Data Collector Service
**What:** Collects metrics from CloudWatch every 5 minutes
**How:** Lambda Function triggered by EventBridge

```bash
# Build the service
cd services/data-collector
pnpm install
pnpm build

# Package for Lambda
zip -r data-collector.zip dist node_modules package.json

# Create Lambda function
aws lambda create-function \
  --function-name cloudops-data-collector \
  --runtime nodejs22.x \
  --handler dist/handlers/collect-metrics.handler \
  --zip-file fileb://data-collector.zip \
  --role arn:aws:iam::YOUR_ACCOUNT_ID:role/cloudops-lambda-role \
  --timeout 60 \
  --memory-size 512
```

**Expected Result:** Lambda function ready to collect data

### Step 1.3: Create IAM Role for Lambda
**What:** Permissions for Lambda to access DynamoDB, CloudWatch, Cost Explorer

```bash
# Create role (we'll provide the JSON policy)
aws iam create-role \
  --role-name cloudops-lambda-role \
  --assume-role-policy-document file://lambda-trust-policy.json

# Attach policies
aws iam attach-role-policy \
  --role-name cloudops-lambda-role \
  --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole

# Attach custom policy for DynamoDB and CloudWatch
aws iam put-role-policy \
  --role-name cloudops-lambda-role \
  --policy-name cloudops-permissions \
  --policy-document file://cloudops-policy.json
```

---

## üåê Phase 2: Frontend Deployment

### Step 2.1: Build Frontend for Production
```bash
cd frontend/dashboard

# Set API Gateway URL from Phase 1
export NEXT_PUBLIC_API_URL=https://YOUR_API_GATEWAY_URL

# Build production bundle
pnpm build
```

### Step 2.2: Create S3 Bucket for Hosting
```bash
# Create bucket
aws s3 mb s3://cloudops-dashboard-demo

# Enable static website hosting
aws s3 website s3://cloudops-dashboard-demo \
  --index-document index.html \
  --error-document index.html

# Upload build files
aws s3 sync .next/static s3://cloudops-dashboard-demo/_next/static
aws s3 sync public s3://cloudops-dashboard-demo/public

# Make bucket public (for demo only)
aws s3api put-bucket-policy \
  --bucket cloudops-dashboard-demo \
  --policy file://bucket-policy.json
```

### Step 2.3: Create CloudFront Distribution
```bash
aws cloudfront create-distribution \
  --origin-domain-name cloudops-dashboard-demo.s3.ap-southeast-2.amazonaws.com \
  --default-root-object index.html
```

**Expected Result:** CloudFront URL like `https://d1234567890.cloudfront.net`

---

## ‚è∞ Phase 3: Automation Setup

### Step 3.1: Create EventBridge Schedule for Metrics Collection
```bash
# Create rule to run every 5 minutes
aws events put-rule \
  --name cloudops-collect-metrics \
  --schedule-expression "rate(5 minutes)"

# Add Lambda as target
aws events put-targets \
  --rule cloudops-collect-metrics \
  --targets "Id"="1","Arn"="arn:aws:lambda:ap-southeast-2:YOUR_ACCOUNT_ID:function:cloudops-data-collector"

# Grant EventBridge permission to invoke Lambda
aws lambda add-permission \
  --function-name cloudops-data-collector \
  --statement-id AllowEventBridge \
  --action lambda:InvokeFunction \
  --principal events.amazonaws.com
```

### Step 3.2: Create EventBridge Schedule for Cost Collection
```bash
# Create rule to run daily at midnight UTC
aws events put-rule \
  --name cloudops-collect-costs \
  --schedule-expression "cron(0 0 * * ? *)"

# Add Lambda as target (costs handler)
# (similar to above)
```

**Expected Result:** Automatic data collection every 5 minutes

---

## üß™ Phase 4: Testing & Demo Data

### Step 4.1: Manual Test Collection
```bash
# Invoke data collector manually to populate initial data
aws lambda invoke \
  --function-name cloudops-data-collector \
  --payload '{}' \
  response.json

# Check DynamoDB for data
aws dynamodb scan \
  --table-name cloudops-metrics \
  --limit 5
```

### Step 4.2: Test API Gateway
```bash
# Test metrics endpoint
curl https://YOUR_API_GATEWAY_URL/api/metrics

# Test costs endpoint
curl https://YOUR_API_GATEWAY_URL/api/costs
```

### Step 4.3: Test Frontend
```bash
# Open CloudFront URL in browser
# Navigate to all pages:
# - / (home)
# - /metrics
# - /costs
# - /anomalies
# - /alerts
```

### Step 4.4: Populate Demo Data
```bash
# Run the mock data insertion script
node scripts/insert-mock-data.js

# Verify data in DynamoDB
aws dynamodb scan --table-name cloudops-metrics --limit 10
aws dynamodb scan --table-name cloudops-costs --limit 10
```

---

## üí∞ Cost Estimation (Monthly)

**DynamoDB:**
- On-demand mode: ~$2-5/month (demo usage)

**Lambda:**
- Free tier: 1M requests/month, 400,000 GB-seconds
- Demo usage: ~$0-1/month

**API Gateway:**
- HTTP API: $1/million requests
- Demo usage: ~$0-1/month

**CloudFront:**
- Free tier: 1TB data transfer/month
- Demo usage: ~$0-2/month

**S3:**
- Standard storage: $0.023/GB
- Demo usage: ~$0.10/month

**EventBridge:**
- Free for first 5M events
- Demo usage: $0/month

**Total Estimated Cost: $3-10/month** ‚úÖ Well under $20 budget

---

## üé¨ Demo Script

### What to Show:

1. **Live Dashboard**
   - Open CloudFront URL
   - Show modern, professional UI
   - Navigate through all 5 pages

2. **Real-Time Metrics**
   - Show Metrics page with last 24 hours of data
   - Filter by metric type (CPU, Network, Disk)
   - Show interactive table with real data

3. **Cost Analysis**
   - Show Costs page with 30-day breakdown
   - Highlight service-level cost breakdown
   - Show total costs and daily average

4. **Anomaly Detection**
   - Show Anomalies page with detected issues
   - Filter by severity (Critical, Warning, Info)
   - Explain how anomalies are detected

5. **Alert Management**
   - Show Alerts page with active alerts
   - Demonstrate acknowledge/resolve actions
   - Show alert statistics

6. **Backend Architecture**
   - Show AWS Console with deployed resources
   - Show Lambda functions
   - Show DynamoDB tables with data
   - Show EventBridge schedules running
   - Show API Gateway routes

### Key Talking Points:

‚úÖ **Microservices Architecture**: 5 independent services
‚úÖ **Serverless**: All Lambda, no servers to manage
‚úÖ **Event-Driven**: EventBridge for scheduling
‚úÖ **Scalable**: DynamoDB auto-scaling, Lambda concurrency
‚úÖ **Modern Frontend**: Next.js 15 with App Router
‚úÖ **Production-Ready**: CI/CD pipelines, tests, monitoring
‚úÖ **Cost-Optimized**: Runs for <$10/month

---

## üõ†Ô∏è Deployment Automation Script

We'll create a single deployment script to automate everything:

**File:** `scripts/deploy-to-aws.sh`

This script will:
1. Build all services
2. Create Lambda functions
3. Set up API Gateway
4. Deploy frontend to S3 + CloudFront
5. Configure EventBridge schedules
6. Run smoke tests

---

## üìù Required Configuration Files

We need to create these files for deployment:

1. **lambda-trust-policy.json** - IAM role trust relationship
2. **cloudops-policy.json** - IAM permissions for Lambda
3. **bucket-policy.json** - S3 public access for demo
4. **api-gateway-config.json** - API Gateway routes
5. **deploy-to-aws.sh** - Master deployment script

---

## ‚ö†Ô∏è Important Notes

### Security for Demo:
- ‚ùå No authentication (for demo simplicity)
- ‚ö†Ô∏è Public S3 bucket (demo only)
- ‚ö†Ô∏è Open CORS (demo only)
- ‚úÖ IAM least privilege for Lambda
- ‚úÖ Encryption at rest (DynamoDB)

### Post-Demo Cleanup:
```bash
# Delete CloudFront distribution
# Delete S3 bucket
# Delete Lambda functions
# Delete API Gateway
# Delete EventBridge rules
# Keep DynamoDB tables (data persistence)
```

### Production Considerations (Future):
- Add Cognito authentication
- Restrict S3 bucket access
- Add WAF rules to API Gateway
- Implement proper CORS
- Add CloudWatch alarms
- Set up X-Ray tracing

---

## üéØ Success Criteria

Demo is ready when:
- [ ] Frontend accessible via CloudFront URL
- [ ] All 5 pages load without errors
- [ ] Metrics page shows real data
- [ ] Costs page shows cost breakdown
- [ ] Data auto-updates every 5 minutes
- [ ] API responds in <1 second
- [ ] No console errors in browser
- [ ] Mobile responsive works
- [ ] Can navigate without issues
- [ ] Demo script rehearsed

---

## üö¶ Next Steps

1. **Review this plan** - Any changes needed?
2. **Create deployment scripts** - Automate everything
3. **Create IAM policies** - Define permissions
4. **Test locally first** - Ensure everything builds
5. **Deploy to AWS** - Run the deployment script
6. **Test thoroughly** - Verify all features work
7. **Create demo video** - Record walkthrough
8. **Practice demo** - Rehearse talking points

**Estimated Total Time: 1 day for full deployment + testing**

---

## üìû Support Resources

- AWS Lambda Limits: https://docs.aws.amazon.com/lambda/latest/dg/limits.html
- API Gateway Pricing: https://aws.amazon.com/api-gateway/pricing/
- CloudFront Setup: https://docs.aws.amazon.com/cloudfront/latest/DeveloperGuide/
- DynamoDB Best Practices: https://docs.aws.amazon.com/dynamodb/latest/developerguide/best-practices.html

---

Ready to proceed with creating the deployment scripts?
